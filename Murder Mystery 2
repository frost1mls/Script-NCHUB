-- NCHUB - VersÃ£o Final com Autofarm MM2
-- ID do Logo: 136836598337495

local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local LP = Players.LocalPlayer

-- ==================== INTERFACE PRINCIPAL ====================

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "NCHUB"
screenGui.Parent = LP:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- [INTRODUÃ‡ÃƒO]
local loadingFrame = Instance.new("Frame")
loadingFrame.Size = UDim2.new(0, 150, 0, 70)
loadingFrame.Position = UDim2.new(0.5, -75, 0.5, -35)
loadingFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
loadingFrame.Parent = screenGui
loadingFrame.ZIndex = 10
Instance.new("UICorner", loadingFrame).CornerRadius = UDim.new(0, 12)

local loadingText = Instance.new("TextLabel")
loadingText.Size = UDim2.new(1, 0, 1, 0)
loadingText.Text = "NCHUB"
loadingText.TextColor3 = Color3.fromRGB(255, 255, 255)
loadingText.Font = Enum.Font.GothamBold
loadingText.TextSize = 28
loadingText.BackgroundTransparency = 1
loadingText.Parent = loadingFrame

-- [GUI PRINCIPAL]
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 500, 0, 400)
mainFrame.Position = UDim2.new(0.5, -250, 0.5, -200)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
mainFrame.ClipsDescendants = true
mainFrame.Visible = false 
mainFrame.Parent = screenGui
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 16)

-- TOP BAR
local topBar = Instance.new("Frame")
topBar.Size = UDim2.new(1, 0, 0, 50)
topBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
topBar.Parent = mainFrame
Instance.new("UICorner", topBar).CornerRadius = UDim.new(0, 16)

-- LOGO DA TOPBAR
local hubLogo = Instance.new("ImageLabel")
hubLogo.Name = "HubLogo"
hubLogo.Size = UDim2.new(0, 40, 0, 40)
hubLogo.Position = UDim2.new(0, 8, 0.5, -20)
hubLogo.BackgroundTransparency = 1
hubLogo.Image = "rbxassetid://136836598337495"
hubLogo.ScaleType = Enum.ScaleType.Fit
hubLogo.Parent = topBar
Instance.new("UICorner", hubLogo).CornerRadius = UDim.new(1, 0)

local hubName = Instance.new("TextLabel")
hubName.Size = UDim2.new(0, 120, 1, 0)
hubName.Position = UDim2.new(0, 55, 0, 0)
hubName.BackgroundTransparency = 1
hubName.Text = "NCHUB"
hubName.TextColor3 = Color3.fromRGB(255, 255, 255)
hubName.Font = Enum.Font.GothamBold
hubName.TextSize = 20
hubName.TextXAlignment = Enum.TextXAlignment.Left
hubName.Parent = topBar

-- [BOTÃ•ES DA TOPBAR]
local buttonContainer = Instance.new("Frame")
buttonContainer.Size = UDim2.new(0, 160, 1, 0)
buttonContainer.Position = UDim2.new(1, -170, 0, 0)
buttonContainer.BackgroundTransparency = 1
buttonContainer.Parent = topBar

local function CreateTopBtn(pos, img, parent)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 40, 1, 0)
    btn.Position = pos
    btn.BackgroundTransparency = 1
    btn.Text = ""
    btn.Parent = parent
    
    local icon = Instance.new("ImageLabel")
    icon.Size = UDim2.new(0, 26, 0, 26)
    icon.Position = UDim2.new(0.5, -13, 0.5, -13)
    icon.BackgroundTransparency = 1
    icon.Image = "rbxassetid://" .. img
    icon.ScaleType = Enum.ScaleType.Fit
    icon.Parent = btn
    
    return btn, icon
end

local configBtn, configIcon = CreateTopBtn(UDim2.new(0, 0, 0, 0), "90478803942823", buttonContainer)
local minMaxBtn, minMaxIcon = CreateTopBtn(UDim2.new(0, 40, 0, 0), "80618521858488", buttonContainer)
local closeBtn, closeIcon = CreateTopBtn(UDim2.new(0, 80, 0, 0), "91221634288964", buttonContainer)
local helpBtn, helpIcon = CreateTopBtn(UDim2.new(0, 120, 0, 0), "95556025403965", buttonContainer)

-- [CONTAINER DE ABAS]
local tabContainer = Instance.new("Frame")
tabContainer.Size = UDim2.new(1, 0, 0, 45)
tabContainer.Position = UDim2.new(0, 0, 0, 50)
tabContainer.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
tabContainer.Parent = mainFrame

-- [ABAS]
local function CreateTab(pos, text, parent)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 100, 1, 0)
    btn.Position = UDim2.new(0, pos, 0, 0)
    btn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    btn.BackgroundTransparency = 0.5
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 16
    btn.Parent = parent
    
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    
    return btn
end

local tabFarm = CreateTab(5, "AUTOFARM", tabContainer)
local tabVisual = CreateTab(110, "VISUAL", tabContainer)
local tabPlayer = CreateTab(215, "PLAYER", tabContainer)
local tabConfig = CreateTab(320, "CONFIG", tabContainer)

-- [CONTEÃšDO DAS ABAS]
local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, -20, 1, -120)
contentFrame.Position = UDim2.new(0, 10, 0, 105)
contentFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
contentFrame.BackgroundTransparency = 0.5
contentFrame.Parent = mainFrame
Instance.new("UICorner", contentFrame).CornerRadius = UDim.new(0, 12)

-- ==================== AUTOFARM MM2 ====================

-- VariÃ¡veis do autofarm
local isRunning = false
local velocidade = 30
local modoAuto = "moedas" -- moedas, guns, boxes

-- FunÃ§Ã£o para atualizar personagem
local function atualizarPersonagem()
    Char = LP.Character or LP.CharacterAdded:Wait()
    HRP = Char:WaitForChild("HumanoidRootPart")
    Humanoid = Char:WaitForChild("Humanoid")
end

atualizarPersonagem()

-- [CONTEÃšDO DA ABA AUTOFARM]
local farmFrame = Instance.new("Frame")
farmFrame.Size = UDim2.new(1, -20, 1, -20)
farmFrame.Position = UDim2.new(0, 10, 0, 10)
farmFrame.BackgroundTransparency = 1
farmFrame.Parent = contentFrame
farmFrame.Visible = true

-- Status do autofarm
local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(1, 0, 0, 35)
statusLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
statusLabel.BackgroundTransparency = 0.3
statusLabel.Text = "ðŸ”´ AUTOFARM DESLIGADO"
statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
statusLabel.Font = Enum.Font.GothamBold
statusLabel.TextSize = 18
statusLabel.Parent = farmFrame
Instance.new("UICorner", statusLabel).CornerRadius = UDim.new(0, 8)

-- BotÃ£o toggle
local toggleFarmBtn = Instance.new("TextButton")
toggleFarmBtn.Size = UDim2.new(1, 0, 0, 45)
toggleFarmBtn.Position = UDim2.new(0, 0, 0, 45)
toggleFarmBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
toggleFarmBtn.Text = "LIGAR AUTOFARM (T)"
toggleFarmBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleFarmBtn.Font = Enum.Font.GothamBold
toggleFarmBtn.TextSize = 18
toggleFarmBtn.Parent = farmFrame
Instance.new("UICorner", toggleFarmBtn).CornerRadius = UDim.new(0, 8)

-- Velocidade slider
local speedLabel = Instance.new("TextLabel")
speedLabel.Size = UDim2.new(0.5, -5, 0, 30)
speedLabel.Position = UDim2.new(0, 0, 0, 100)
speedLabel.BackgroundTransparency = 1
speedLabel.Text = "Velocidade: 30"
speedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
speedLabel.Font = Enum.Font.GothamBold
speedLabel.TextSize = 16
speedLabel.TextXAlignment = Enum.TextXAlignment.Left
speedLabel.Parent = farmFrame

local speedSlider = Instance.new("TextBox")
speedSlider.Size = UDim2.new(0.5, -5, 0, 35)
speedSlider.Position = UDim2.new(0.5, 5, 0, 95)
speedSlider.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
speedSlider.Text = "30"
speedSlider.TextColor3 = Color3.fromRGB(255, 255, 255)
speedSlider.Font = Enum.Font.GothamBold
speedSlider.TextSize = 18
speedSlider.Parent = farmFrame
Instance.new("UICorner", speedSlider).CornerRadius = UDim.new(0, 8)

-- Modo selector
local modoLabel = Instance.new("TextLabel")
modoLabel.Size = UDim2.new(1, 0, 0, 30)
modoLabel.Position = UDim2.new(0, 0, 0, 140)
modoLabel.BackgroundTransparency = 1
modoLabel.Text = "Modo de coleta:"
modoLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
modoLabel.Font = Enum.Font.GothamBold
modoLabel.TextSize = 16
modoLabel.TextXAlignment = Enum.TextXAlignment.Left
modoLabel.Parent = farmFrame

local modoMoedas = Instance.new("TextButton")
modoMoedas.Size = UDim2.new(0.33, -3, 0, 35)
modoMoedas.Position = UDim2.new(0, 0, 0, 175)
modoMoedas.BackgroundColor3 = Color3.fromRGB(0, 255, 100)
modoMoedas.Text = "ðŸ’° MOEDAS"
modoMoedas.TextColor3 = Color3.fromRGB(0, 0, 0)
modoMoedas.Font = Enum.Font.GothamBold
modoMoedas.TextSize = 14
modoMoedas.Parent = farmFrame
Instance.new("UICorner", modoMoedas).CornerRadius = UDim.new(0, 8)

local modoGuns = Instance.new("TextButton")
modoGuns.Size = UDim2.new(0.33, -3, 0, 35)
modoGuns.Position = UDim2.new(0.34, 2, 0, 175)
modoGuns.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
modoGuns.Text = "ðŸ”« ARMAS"
modoGuns.TextColor3 = Color3.fromRGB(255, 255, 255)
modoGuns.Font = Enum.Font.GothamBold
modoGuns.TextSize = 14
modoGuns.Parent = farmFrame
Instance.new("UICorner", modoGuns).CornerRadius = UDim.new(0, 8)

local modoBoxes = Instance.new("TextButton")
modoBoxes.Size = UDim2.new(0.33, -3, 0, 35)
modoBoxes.Position = UDim2.new(0.67, 4, 0, 175)
modoBoxes.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
modoBoxes.Text = "ðŸ“¦ BOXES"
modoBoxes.TextColor3 = Color3.fromRGB(255, 255, 255)
modoBoxes.Font = Enum.Font.GothamBold
modoBoxes.TextSize = 14
modoBoxes.Parent = farmFrame
Instance.new("UICorner", modoBoxes).CornerRadius = UDim.new(0, 8)

-- ==================== FUNÃ‡Ã•ES DO AUTOFARM ====================

-- FunÃ§Ã£o para encontrar a moeda mais prÃ³xima
local function encontrarMoedaMaisProxima()
    local mapa = nil
    for _, obj in ipairs(workspace:GetChildren()) do
        if obj:FindFirstChild("CoinContainer") or obj:FindFirstChild("Coins") then
            mapa = obj
            break
        end
    end
    
    if not mapa then return nil end
    
    local container = mapa:FindFirstChild("CoinContainer") or mapa:FindFirstChild("Coins")
    if not container then return nil end
    
    local moedaMaisProxima = nil
    local menorDistancia = math.huge
    
    for _, moeda in ipairs(container:GetChildren()) do
        local visual = moeda:FindFirstChild("CoinVisual")
        if visual and not visual:GetAttribute("Collected") then
            local distancia = (HRP.Position - moeda.Position).Magnitude
            if distancia < menorDistancia then
                moedaMaisProxima = moeda
                menorDistancia = distancia
            end
        end
    end
    
    return moedaMaisProxima
end

-- FunÃ§Ã£o para teleportar suave
local function irAteMoeda(moeda)
    if not moeda or not HRP or not Humanoid then return end
    
    Humanoid:ChangeState(Enum.HumanoidStateType.Physics)
    
    local distancia = (HRP.Position - moeda.Position).Magnitude
    local tempoViagem = distancia / velocidade
    
    local tween = TweenService:Create(
        HRP, 
        TweenInfo.new(tempoViagem, Enum.EasingStyle.Linear),
        {CFrame = moeda.CFrame}
    )
    
    tween:Play()
    tween.Completed:Wait()
    
    Humanoid:ChangeState(Enum.HumanoidStateType.Running)
end

-- Atualizar status
local function atualizarStatus()
    if isRunning then
        statusLabel.Text = "ðŸŸ¢ AUTOFARM LIGADO"
        statusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        toggleFarmBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        toggleFarmBtn.Text = "DESLIGAR AUTOFARM (T)"
    else
        statusLabel.Text = "ðŸ”´ AUTOFARM DESLIGADO"
        statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        toggleFarmBtn.BackgroundColor3 = Color3.fromRGB(50, 255, 50)
        toggleFarmBtn.Text = "LIGAR AUTOFARM (T)"
    end
end

-- ==================== BOTÃ•ES E EVENTOS ====================

-- BotÃ£o toggle farm
toggleFarmBtn.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    atualizarStatus()
end)

-- Tecla T
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.T then
        isRunning = not isRunning
        atualizarStatus()
    end
end)

-- Slider de velocidade
speedSlider.FocusLost:Connect(function()
    local valor = tonumber(speedSlider.Text)
    if valor and valor > 0 and valor <= 200 then
        velocidade = valor
        speedLabel.Text = "Velocidade: " .. valor
    else
        speedSlider.Text = tostring(velocidade)
    end
end)

-- Modos de coleta
modoMoedas.MouseButton1Click:Connect(function()
    modoAuto = "moedas"
    modoMoedas.BackgroundColor3 = Color3.fromRGB(0, 255, 100)
    modoMoedas.TextColor3 = Color3.fromRGB(0, 0, 0)
    modoGuns.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    modoGuns.TextColor3 = Color3.fromRGB(255, 255, 255)
    modoBoxes.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    modoBoxes.TextColor3 = Color3.fromRGB(255, 255, 255)
end)

modoGuns.MouseButton1Click:Connect(function()
    modoAuto = "guns"
    modoGuns.BackgroundColor3 = Color3.fromRGB(0, 255, 100)
    modoGuns.TextColor3 = Color3.fromRGB(0, 0, 0)
    modoMoedas.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    modoMoedas.TextColor3 = Color3.fromRGB(255, 255, 255)
    modoBoxes.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    modoBoxes.TextColor3 = Color3.fromRGB(255, 255, 255)
end)

modoBoxes.MouseButton1Click:Connect(function()
    modoAuto = "boxes"
    modoBoxes.BackgroundColor3 = Color3.fromRGB(0, 255, 100)
    modoBoxes.TextColor3 = Color3.fromRGB(0, 0, 0)
    modoMoedas.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    modoMoedas.TextColor3 = Color3.fromRGB(255, 255, 255)
    modoGuns.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    modoGuns.TextColor3 = Color3.fromRGB(255, 255, 255)
end)

-- ==================== LOOP PRINCIPAL ====================

spawn(function()
    while true do
        if isRunning then
            local moeda = encontrarMoedaMaisProxima()
            
            if moeda then
                irAteMoeda(moeda)
                
                local visual = moeda:FindFirstChild("CoinVisual")
                if visual then
                    repeat
                        task.wait(0.1)
                    until not visual.Parent or visual:GetAttribute("Collected")
                end
            else
                task.wait(0.5)
            end
        else
            task.wait(0.1)
        end
    end
end)

-- ==================== FUNÃ‡Ã•ES DA INTERFACE ====================

-- FunÃ§Ã£o drag
local function MakeDraggable(obj, dragObj)
    local dragging, dragStart, startPos
    obj.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = dragObj.Position
        end
    end)
    
    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            dragObj.Position = UDim2.new(
                startPos.X.Scale, 
                startPos.X.Offset + delta.X, 
                startPos.Y.Scale, 
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    obj.InputEnded:Connect(function()
        dragging = false
    end)
end

MakeDraggable(topBar, mainFrame)

-- BotÃµes da topbar
closeBtn.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

local minimized = false
minMaxBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        mainFrame:TweenSize(UDim2.new(0, 500, 0, 50), "Out", "Quad", 0.2, true)
        minMaxIcon.Image = "rbxassetid://90771774993802"
    else
        mainFrame:TweenSize(UDim2.new(0, 500, 0, 400), "Out", "Quad", 0.2, true)
        minMaxIcon.Image = "rbxassetid://80618521858488"
    end
end)

-- Trocar abas
local function mostrarAba(aba)
    farmFrame.Visible = (aba == "farm")
    -- Adicionar mais abas depois
end

tabFarm.MouseButton1Click:Connect(function() mostrarAba("farm") end)
tabVisual.MouseButton1Click:Connect(function() mostrarAba("visual") end)
tabPlayer.MouseButton1Click:Connect(function() mostrarAba("player") end)
tabConfig.MouseButton1Click:Connect(function() mostrarAba("config") end)

-- ==================== INTRO E BOTÃƒO TOGGLE ====================

task.wait(2)
loadingFrame:TweenPosition(UDim2.new(0.5, -75, 1.5, 0), "Out", "Quad", 0.5, true)
task.wait(0.5)
loadingFrame:Destroy()

local toggleBtn = Instance.new("ImageButton")
toggleBtn.Name = "ToggleButton"
toggleBtn.Size = UDim2.new(0, 60, 0, 60)
toggleBtn.Position = UDim2.new(0, 15, 0.5, -30)
toggleBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
toggleBtn.BackgroundTransparency = 0.1
toggleBtn.Image = "rbxassetid://136836598337495"
toggleBtn.ScaleType = Enum.ScaleType.Fit
toggleBtn.Parent = screenGui
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1, 0)
Instance.new("UIStroke", toggleBtn).Thickness = 2.5

MakeDraggable(toggleBtn, toggleBtn)
toggleBtn.MouseButton1Click:Connect(function()
    mainFrame.Visible = not mainFrame.Visible
end)

mainFrame.Visible = true

-- ==================== ATUALIZAR PERSONAGEM ====================

LP.CharacterAdded:Connect(function(novoChar)
    Char = novoChar
    HRP = Char:WaitForChild("HumanoidRootPart")
    Humanoid = Char:WaitForChild("Humanoid")
end)

print("ðŸš€ NCHUB carregado! Pressione T para ligar/desligar autofarm")
