-- NCHUB - Murder Mystery 2
-- Baseado em script funcional 2026
-- SUA BIBLIOTECA PRESERVADA + FUN√á√ïES REAIS

-- Criar tela
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "NCHUB"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Tela de carregamento
local loadingFrame = Instance.new("Frame")
loadingFrame.Name = "Loading"
loadingFrame.Size = UDim2.new(0, 150, 0, 70)
loadingFrame.Position = UDim2.new(0.5, -75, 0.5, -35)
loadingFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
loadingFrame.BackgroundTransparency = 0.1
loadingFrame.BorderSizePixel = 0
loadingFrame.Parent = screenGui
loadingFrame.ZIndex = 10

local loadingCorner = Instance.new("UICorner")
loadingCorner.CornerRadius = UDim.new(0, 12)
loadingCorner.Parent = loadingFrame

local loadingText = Instance.new("TextLabel")
loadingText.Size = UDim2.new(1, 0, 1, 0)
loadingText.BackgroundTransparency = 1
loadingText.Text = "NCHUB"
loadingText.TextColor3 = Color3.fromRGB(255, 255, 255)
loadingText.Font = Enum.Font.GothamBold
loadingText.TextSize = 28
loadingText.Parent = loadingFrame

-- Aguardar 2 segundos
task.wait(2)

loadingFrame:TweenPosition(UDim2.new(0.5, -75, 1.5, 0), "Out", "Quad", 0.5, true)
task.wait(0.5)
loadingFrame:Destroy()

-- GUI Principal
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 450, 0, 380) -- Aumentei pra caber tudo
mainFrame.Position = UDim2.new(0.5, -225, 0.5, -190)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 16)
mainCorner.Parent = mainFrame

-- TOP BAR
local topBar = Instance.new("Frame")
topBar.Name = "TopBar"
topBar.Size = UDim2.new(1, 0, 0, 45)
topBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
topBar.BorderSizePixel = 0
topBar.Parent = mainFrame

local topBarCorner = Instance.new("UICorner")
topBarCorner.CornerRadius = UDim.new(0, 16)
topBarCorner.Parent = topBar

-- Nome do Hub
local hubName = Instance.new("TextLabel")
hubName.Size = UDim2.new(0, 120, 1, 0)
hubName.Position = UDim2.new(0, 12, 0, 0)
hubName.BackgroundTransparency = 1
hubName.Text = "NCHUB - MM2"
hubName.TextColor3 = Color3.fromRGB(255, 255, 255)
hubName.Font = Enum.Font.GothamBold
hubName.TextSize = 16
hubName.TextXAlignment = Enum.TextXAlignment.Left
hubName.Parent = topBar

-- Container dos bot√µes
local buttonContainer = Instance.new("Frame")
buttonContainer.Size = UDim2.new(0, 120, 1, 0)
buttonContainer.Position = UDim2.new(1, -130, 0, 0)
buttonContainer.BackgroundTransparency = 1
buttonContainer.Parent = topBar

-- Bot√£o Config
local configBtn = Instance.new("TextButton")
configBtn.Size = UDim2.new(0, 30, 1, 0)
configBtn.Position = UDim2.new(0, 0, 0, 0)
configBtn.BackgroundTransparency = 1
configBtn.Text = "‚öôÔ∏è"
configBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
configBtn.TextSize = 20
configBtn.Font = Enum.Font.Gotham
configBtn.Parent = buttonContainer

-- Bot√£o Minimizar/Maximizar
local minMaxBtn = Instance.new("TextButton")
minMaxBtn.Size = UDim2.new(0, 30, 1, 0)
minMaxBtn.Position = UDim2.new(0, 30, 0, 0)
minMaxBtn.BackgroundTransparency = 1
minMaxBtn.Text = "‚àí"
minMaxBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
minMaxBtn.TextSize = 24
minMaxBtn.Font = Enum.Font.GothamBold
minMaxBtn.Parent = buttonContainer

-- Bot√£o Fechar
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 30, 1, 0)
closeBtn.Position = UDim2.new(0, 60, 0, 0)
closeBtn.BackgroundTransparency = 1
closeBtn.Text = "‚úï"
closeBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
closeBtn.TextSize = 18
closeBtn.Font = Enum.Font.GothamBold
closeBtn.Parent = buttonContainer

-- Bot√£o Ajuda
local helpBtn = Instance.new("TextButton")
helpBtn.Size = UDim2.new(0, 30, 1, 0)
helpBtn.Position = UDim2.new(0, 90, 0, 0)
helpBtn.BackgroundTransparency = 1
helpBtn.Text = "?"
helpBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
helpBtn.TextSize = 20
helpBtn.Font = Enum.Font.GothamBold
helpBtn.Parent = buttonContainer

-- √Årea de Conte√∫do (ScrollingFrame)
local contentArea = Instance.new("ScrollingFrame")
contentArea.Name = "ContentArea"
contentArea.Size = UDim2.new(1, -20, 1, -60)
contentArea.Position = UDim2.new(0, 10, 0, 55)
contentArea.BackgroundTransparency = 1
contentArea.BorderSizePixel = 0
contentArea.ScrollBarThickness = 4
contentArea.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
contentArea.CanvasSize = UDim2.new(0, 0, 0, 0)
contentArea.Parent = mainFrame

-- ========== SEU C√ìDIGO DA BIBLIOTECA AT√â AQUI ==========

-- Dragging
local dragging = false
local dragStart
local startPos

topBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

topBar.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging then
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end
end)

-- Fechar
closeBtn.MouseButton1Click:Connect(function() screenGui:Destroy() end)

-- Minimizar/Maximizar
local minimized = false
local originalSize = mainFrame.Size
local minimizedSize = UDim2.new(0, 450, 0, 45)

minMaxBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        mainFrame:TweenSize(minimizedSize, "Out", "Quad", 0.2, true)
        minMaxBtn.Text = "+"
        contentArea.Visible = false
    else
        mainFrame:TweenSize(originalSize, "Out", "Quad", 0.2, true)
        minMaxBtn.Text = "‚àí"
        contentArea.Visible = true
    end
end)

-- Config e Ajuda
configBtn.MouseButton1Click:Connect(function()
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "NCHUB",
        Text = "Configura√ß√µes - Em breve!",
        Duration = 2
    })
end)

helpBtn.MouseButton1Click:Connect(function()
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "NCHUB",
        Text = "NCHUB - Murder Mystery 2\nDiscord.gg/SEU_SERVIDOR",
        Duration = 3
    })
end)

-- ========== AGORA VAMOS CARREGAR AS FUN√á√ïES REAIS ==========

-- Primeiro, garantir que nada conflita
local function loadScript(url)
    local success, result = pcall(function()
        return game:HttpGet(url)
    end)
    if success then
        local func, err = loadstring(result)
        if func then
            -- Executa num ambiente seguro
            local env = getfenv()
            setfenv(func, env)
            func()
        end
    end
end

-- ========== SISTEMA DE TABS USANDO SUA BIBLIOTECA ==========

-- Container das Tabs
local tabContainer = Instance.new("Frame")
tabContainer.Size = UDim2.new(1, -20, 0, 40)
tabContainer.Position = UDim2.new(0, 10, 0, 10)
tabContainer.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
tabContainer.BorderSizePixel = 0
tabContainer.Parent = contentArea

local tabContainerCorner = Instance.new("UICorner")
tabContainerCorner.CornerRadius = UDim.new(0, 8)
tabContainerCorner.Parent = tabContainer

-- Conte√∫do das Tabs (vai abaixo das abas)
local tabContentArea = Instance.new("Frame")
tabContentArea.Name = "TabContent"
tabContentArea.Size = UDim2.new(1, -20, 0, 280)
tabContentArea.Position = UDim2.new(0, 10, 0, 60)
tabContentArea.BackgroundTransparency = 1
tabContentArea.ClipsDescendants = true
tabContentArea.Parent = contentArea

-- Criar Tabs
local tabs = {
    {name = "AUTO", icon = "‚ö°"},
    {name = "ESP", icon = "üëÅÔ∏è"},
    {name = "PLAYER", icon = "ü¶∏"},
    {name = "TELEPORT", icon = "üìç"},
    {name = "OUTROS", icon = "‚öôÔ∏è"}
}

local tabButtons = {}
local tabContents = {}

for i, tab in ipairs(tabs) do
    -- Bot√£o da tab
    local tabBtn = Instance.new("TextButton")
    tabBtn.Size = UDim2.new(0, 70, 1, 0)
    tabBtn.Position = UDim2.new(0, 5 + (i-1) * 75, 0, 0)
    tabBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 48)
    tabBtn.Text = tab.icon .. " " .. tab.name
    tabBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
    tabBtn.Font = Enum.Font.GothamBold
    tabBtn.TextSize = 13
    tabBtn.Parent = tabContainer
    
    local tabBtnCorner = Instance.new("UICorner")
    tabBtnCorner.CornerRadius = UDim.new(0, 6)
    tabBtnCorner.Parent = tabBtn
    
    -- Container da tab (ScrollingFrame)
    local tabContent = Instance.new("ScrollingFrame")
    tabContent.Name = "Tab_" .. tab.name
    tabContent.Size = UDim2.new(1, 0, 1, 0)
    tabContent.BackgroundTransparency = 1
    tabContent.BorderSizePixel = 0
    tabContent.ScrollBarThickness = 4
    tabContent.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
    tabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
    tabContent.Visible = false
    tabContent.Parent = tabContentArea
    
    table.insert(tabButtons, tabBtn)
    tabContents[tab.name] = tabContent
    
    tabBtn.MouseButton1Click:Connect(function()
        for _, btn in ipairs(tabButtons) do
            btn.BackgroundColor3 = Color3.fromRGB(40, 40, 48)
        end
        for _, content in pairs(tabContents) do
            content.Visible = false
        end
        tabBtn.BackgroundColor3 = Color3.fromRGB(70, 70, 90)
        tabContent.Visible = true
    end)
end

-- Selecionar primeira tab
if tabButtons[1] then
    tabButtons[1].BackgroundColor3 = Color3.fromRGB(70, 70, 90)
    tabContents["AUTO"].Visible = true
end

-- ========== FUN√á√ïES AUXILIARES ==========

local function UpdateCanvas(frame)
    local height = 0
    for _, v in pairs(frame:GetChildren()) do
        if v:IsA("Frame") or v:IsA("TextButton") then
            height = height + v.Size.Y.Offset + 8
        end
    end
    frame.CanvasSize = UDim2.new(0, 0, 0, height + 20)
end

local function CriarBotao(parent, texto, cor, callback)
    local yPos = #parent:GetChildren() * 42
    
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -10, 0, 35)
    btn.Position = UDim2.new(0, 5, 0, yPos)
    btn.BackgroundColor3 = cor or Color3.fromRGB(50, 50, 65)
    btn.Text = texto
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    btn.Parent = parent
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 6)
    btnCorner.Parent = btn
    
    btn.MouseButton1Click:Connect(function()
        callback()
        btn.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
        task.wait(0.1)
        btn.BackgroundColor3 = cor or Color3.fromRGB(50, 50, 65)
    end)
    
    return btn
end

local function CriarToggle(parent, texto, varName)
    local yPos = #parent:GetChildren() * 42
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, -10, 0, 35)
    frame.Position = UDim2.new(0, 5, 0, yPos)
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
    frame.Parent = parent
    
    local frameCorner = Instance.new("UICorner")
    frameCorner.CornerRadius = UDim.new(0, 6)
    frameCorner.Parent = frame
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0, 200, 1, 0)
    label.Position = UDim2.new(0, 10, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = texto
    label.TextColor3 = Color3.fromRGB(220, 220, 220)
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = frame
    
    local toggleBtn = Instance.new("TextButton")
    toggleBtn.Size = UDim2.new(0, 45, 0, 22)
    toggleBtn.Position = UDim2.new(1, -50, 0.5, -11)
    toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 90)
    toggleBtn.Text = "OFF"
    toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleBtn.Font = Enum.Font.GothamBold
    toggleBtn.TextSize = 11
    toggleBtn.Parent = frame
    
    local toggleCorner = Instance.new("UICorner")
    toggleCorner.CornerRadius = UDim.new(0, 4)
    toggleCorner.Parent = toggleBtn
    
    local state = false
    
    toggleBtn.MouseButton1Click:Connect(function()
        state = not state
        if state then
            toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 180, 80)
            toggleBtn.Text = "ON"
        else
            toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 90)
            toggleBtn.Text = "OFF"
        end
        _G[varName] = state
    end)
    
    return frame
end

-- ========== FUN√á√ïES REAIS (baseadas nos scripts funcionais) ==========

-- Configura√ß√µes globais
_G.Settings = {
    SilentAim = { Enabled = false, FOV = 150, Smoothness = 0.45 },
    Aimbot = { Enabled = false, TeamCheck = true },
    AutoFarm = { Coins = false, Candy = false },
    ESP = { Players = false, Items = false },
    Speed = { WalkSpeed = 16, FlySpeed = 50 }
}

-- Servi√ßos
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- Fun√ß√£o ESP
local function UpdateESP()
    if not _G.ESP_Murder and not _G.ESP_Sheriff and not _G.ESP_Innocent then return end
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local role = "Innocent"
            -- Detec√ß√£o b√°sica de papel (voc√™ melhora depois)
            if player.Character:FindFirstChildWhichIsA("Tool") then
                local tool = player.Character:FindFirstChildWhichIsA("Tool")
                if tool and tool.Name:lower():find("knife") then
                    role = "Murderer"
                elseif tool and tool.Name:lower():find("gun") then
                    role = "Sheriff"
                end
            end
            
            local show = (role == "Murderer" and _G.ESP_Murder) or
                        (role == "Sheriff" and _G.ESP_Sheriff) or
                        (role == "Innocent" and _G.ESP_Innocent)
            
            if show then
                -- Criar ESP (simplificado)
                if not player.Character:FindFirstChild("ESP_Highlight") then
                    local highlight = Instance.new("Highlight")
                    highlight.Name = "ESP_Highlight"
                    highlight.FillColor = role == "Murderer" and Color3.new(1, 0, 0) or
                                         role == "Sheriff" and Color3.new(0, 0, 1) or
                                         Color3.new(0, 1, 0)
                    highlight.FillTransparency = 0.5
                    highlight.OutlineTransparency = 1
                    highlight.Parent = player.Character
                end
            else
                local highlight = player.Character:FindFirstChild("ESP_Highlight")
                if highlight then highlight:Destroy() end
            end
        end
    end
end

-- Loop principal
RunService.Heartbeat:Connect(function()
    UpdateESP()
    
    -- Aimbot/Silent Aim (se implementar)
    if _G.Aimbot then
        -- L√≥gica do aimbot
    end
end)

-- Anti AFK
LocalPlayer.Idled:Connect(function()
    if _G.AntiAFK then
        local VirtualUser = game:GetService("VirtualUser")
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end
end)

-- Infinite Jump
UserInputService.JumpRequest:Connect(function()
    if _G.InfiniteJump and LocalPlayer.Character then
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:ChangeState("Jumping")
        end
    end
end)

-- Full Bright
RunService.Heartbeat:Connect(function()
    if _G.FullBright then
        game.Lighting.Brightness = 2
        game.Lighting.Ambient = Color3.new(1, 1, 1)
    else
        game.Lighting.Brightness = 1
        game.Lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
    end
end)

-- ========== PREENCHER TABS ==========

-- Tab AUTO
CriarToggle(tabContents["AUTO"], "‚ö° Auto Farm Coins", "AutoFarmCoins")
CriarToggle(tabContents["AUTO"], "üç¨ Auto Farm Candy", "AutoFarmCandy")
CriarToggle(tabContents["AUTO"], "üî´ Auto Get Gun", "AutoGun")
CriarToggle(tabContents["AUTO"], "üíÄ Kill All", "KillAll")
UpdateCanvas(tabContents["AUTO"])

-- Tab ESP
CriarToggle(tabContents["ESP"], "üî¥ ESP Murder", "ESP_Murder")
CriarToggle(tabContents["ESP"], "üîµ ESP Xerife", "ESP_Sheriff")
CriarToggle(tabContents["ESP"], "üü¢ ESP Inocente", "ESP_Innocent")
CriarToggle(tabContents["ESP"], "üî´ ESP Arma", "ESP_Gun")
UpdateCanvas(tabContents["ESP"])

-- Tab PLAYER
CriarToggle(tabContents["PLAYER"], "üïäÔ∏è Fly", "Fly")
CriarToggle(tabContents["PLAYER"], "üëª Noclip", "Noclip")
CriarToggle(tabContents["PLAYER"], "‚òÅÔ∏è Infinite Jump", "InfiniteJump")
CriarToggle(tabContents["PLAYER"], "üéØ Aimbot", "Aimbot")
CriarToggle(tabContents["PLAYER"], "ü§´ Silent Aim", "SilentAim")
UpdateCanvas(tabContents["PLAYER"])

-- Tab TELEPORT
CriarBotao(tabContents["TELEPORT"], "üè† Teleport Lobby", Color3.fromRGB(200, 150, 50), function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(0, 50, 0)
    end
end)

CriarBotao(tabContents["TELEPORT"], "üó∫Ô∏è Teleport Mapa", Color3.fromRGB(150, 200, 50), function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(100, 50, 100)
    end
end)

CriarBotao(tabContents["TELEPORT"], "üî´ Teleport Arma", Color3.fromRGB(50, 200, 200), function()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("Tool") and (v.Name:lower():find("gun") or v.Name:lower():find("pistol")) then
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(v.Position + Vector3.new(0, 3, 0))
            end
            break
        end
    end
end)
UpdateCanvas(tabContents["TELEPORT"])

-- Tab OUTROS
CriarToggle(tabContents["OUTROS"], "üí° Full Bright", "FullBright")
CriarToggle(tabContents["OUTROS"], "üí§ Anti AFK", "AntiAFK")
CriarToggle(tabContents["OUTROS"], "üöÄ FPS Boost", "FPSBoost")
CriarBotao(tabContents["OUTROS"], "üîÑ Rejoin Server", Color3.fromRGB(150, 150, 150), function()
    game:GetService("TeleportService"):Teleport(game.PlaceId, LocalPlayer)
end)
UpdateCanvas(tabContents["OUTROS"])

-- Atualizar canvas principal
contentArea.CanvasSize = UDim2.new(0, 0, 0, 350)

print("‚úÖ NCHUB - MM2 carregado com sucesso!")
