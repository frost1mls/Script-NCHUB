-- NCHUB - Vers√£o Final (Design Original Preservado)
-- ID: 136836598337495

local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LP = Players.LocalPlayer

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "NCHUB"
screenGui.Parent = LP:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- [INTRODU√á√ÉO]
local loadingFrame = Instance.new("Frame")
loadingFrame.Size = UDim2.new(0, 150, 0, 70)
loadingFrame.Position = UDim2.new(0.5, -75, 0.5, -35)
loadingFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
loadingFrame.Parent = screenGui
loadingFrame.ZIndex = 10
Instance.new("UICorner", loadingFrame).CornerRadius = UDim.new(0, 12)

local loadingText = Instance.new("TextLabel")
loadingText.Size = UDim2.new(1, 0, 1, 0)
loadingText.Text = "NCHUB"
loadingText.TextColor3 = Color3.fromRGB(255, 255, 255)
loadingText.Font = Enum.Font.GothamBold
loadingText.TextSize = 28
loadingText.BackgroundTransparency = 1
loadingText.Parent = loadingFrame

-- [GUI PRINCIPAL]
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 420, 0, 340)
mainFrame.Position = UDim2.new(0.5, -210, 0.5, -170)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
mainFrame.ClipsDescendants = true
mainFrame.Visible = false 
mainFrame.Parent = screenGui
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 16)

-- TOP BAR
local topBar = Instance.new("Frame")
topBar.Size = UDim2.new(1, 0, 0, 45)
topBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
topBar.Parent = mainFrame
Instance.new("UICorner", topBar).CornerRadius = UDim.new(0, 16)

-- LOGO DA TOPBAR (Circular e Clean)
local hubLogo = Instance.new("ImageLabel")
hubLogo.Name = "HubLogo"
hubLogo.Size = UDim2.new(0, 36, 0, 36)
hubLogo.Position = UDim2.new(0, 8, 0.5, -18)
hubLogo.BackgroundTransparency = 1
hubLogo.Image = "rbxassetid://136836598337495"
hubLogo.ScaleType = Enum.ScaleType.Fit
hubLogo.Parent = topBar
Instance.new("UICorner", hubLogo).CornerRadius = UDim.new(1, 0)

local hubName = Instance.new("TextLabel")
hubName.Size = UDim2.new(0, 120, 1, 0)
hubName.Position = UDim2.new(0, 52, 0, 0)
hubName.BackgroundTransparency = 1
hubName.Text = "NCHUB"
hubName.TextColor3 = Color3.fromRGB(255, 255, 255)
hubName.Font = Enum.Font.GothamBold
hubName.TextSize = 18
hubName.TextXAlignment = Enum.TextXAlignment.Left
hubName.Parent = topBar

-- [BOT√ïES DA TOPBAR]
local buttonContainer = Instance.new("Frame")
buttonContainer.Size = UDim2.new(0, 120, 1, 0)
buttonContainer.Position = UDim2.new(1, -130, 0, 0)
buttonContainer.BackgroundTransparency = 1
buttonContainer.Parent = topBar

local function CreateTopBtn(pos, img, parent)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 30, 1, 0)
    btn.Position = pos
    btn.BackgroundTransparency = 1
    btn.Text = ""
    btn.Parent = parent
    
    local icon = Instance.new("ImageLabel")
    icon.Size = UDim2.new(0, 22, 0, 22)
    icon.Position = UDim2.new(0.5, -11, 0.5, -11)
    icon.BackgroundTransparency = 1
    icon.Image = "rbxassetid://" .. img
    icon.ScaleType = Enum.ScaleType.Fit
    icon.Parent = btn
    
    return btn, icon
end

local configBtn, configIcon = CreateTopBtn(UDim2.new(0, 0, 0, 0), "90478803942823", buttonContainer)
local minMaxBtn, minMaxIcon = CreateTopBtn(UDim2.new(0, 30, 0, 0), "80618521858488", buttonContainer)
local closeBtn, closeIcon = CreateTopBtn(UDim2.new(0, 60, 0, 0), "91221634288964", buttonContainer)
local helpBtn, helpIcon = CreateTopBtn(UDim2.new(0, 90, 0, 0), "95556025403965", buttonContainer)

-- [FUN√á√ïES DRAG]
local function MakeDraggable(obj, dragObj)
    local dragging, dragStart, startPos
    obj.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true 
            dragStart = input.Position 
            startPos = dragObj.Position
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
            local delta = input.Position - dragStart
            dragObj.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    obj.InputEnded:Connect(function() 
        dragging = false 
    end)
end

MakeDraggable(topBar, mainFrame)

-- [L√ìGICA DOS BOT√ïES]
closeBtn.MouseButton1Click:Connect(function() 
    screenGui:Destroy() 
end)

local minimized = false
minMaxBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        mainFrame:TweenSize(UDim2.new(0, 420, 0, 45), "Out", "Quad", 0.2, true)
        minMaxIcon.Image = "rbxassetid://90771774993802"
    else
        mainFrame:TweenSize(UDim2.new(0, 420, 0, 340), "Out", "Quad", 0.2, true)
        minMaxIcon.Image = "rbxassetid://80618521858488"
    end
end)

-- [INTRO + BAL√ÉO P√ìS-INTRO]
task.wait(2)
loadingFrame:TweenPosition(UDim2.new(0.5, -75, 1.5, 0), "Out", "Quad", 0.5, true)
task.wait(0.5)
loadingFrame:Destroy()

local toggleBtn = Instance.new("ImageButton")
toggleBtn.Name = "ToggleButton"
toggleBtn.Size = UDim2.new(0, 60, 0, 60)
toggleBtn.Position = UDim2.new(0, 15, 0.5, -30)
toggleBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
toggleBtn.BackgroundTransparency = 0.1
toggleBtn.Image = "rbxassetid://136836598337495"
toggleBtn.ScaleType = Enum.ScaleType.Fit
toggleBtn.Parent = screenGui
Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1, 0)
Instance.new("UIStroke", toggleBtn).Thickness = 2.5

MakeDraggable(toggleBtn, toggleBtn)
toggleBtn.MouseButton1Click:Connect(function() 
    mainFrame.Visible = not mainFrame.Visible 
end)

mainFrame.Visible = true

-- ==================== CONTE√öDO DO HUB ====================

local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, -20, 1, -60)
contentFrame.Position = UDim2.new(0, 10, 0, 50)
contentFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
contentFrame.Parent = mainFrame
Instance.new("UICorner", contentFrame).CornerRadius = UDim.new(0, 12)

-- ==================== VARI√ÅVEIS GLOBAIS ====================

-- Autofarm
local isRunning = false
local velocidade = 30
local Char = LP.Character or LP.CharacterAdded:Wait()
local HRP = Char:WaitForChild("HumanoidRootPart")
local Humanoid = Char:WaitForChild("Humanoid")

-- Kill All
local killAllEnabled = false
local killing = false

-- ESP
local espEnabled = false
local espCache = {}

-- ==================== FUN√á√ïES DO AUTOFARM ====================

local function encontrarMoedaMaisProxima()
    local mapa = nil
    for _, obj in ipairs(workspace:GetChildren()) do
        if obj:FindFirstChild("CoinContainer") or obj:FindFirstChild("Coins") then
            mapa = obj
            break
        end
    end
    
    if not mapa then return nil end
    
    local container = mapa:FindFirstChild("CoinContainer") or mapa:FindFirstChild("Coins")
    if not container then return nil end
    
    local moedaMaisProxima = nil
    local menorDistancia = math.huge
    
    for _, moeda in ipairs(container:GetChildren()) do
        local visual = moeda:FindFirstChild("CoinVisual")
        if visual and not visual:GetAttribute("Collected") then
            local distancia = (HRP.Position - moeda.Position).Magnitude
            if distancia < menorDistancia then
                moedaMaisProxima = moeda
                menorDistancia = distancia
            end
        end
    end
    
    return moedaMaisProxima
end

local function irAteMoeda(moeda)
    if not moeda or not HRP or not Humanoid then return end
    
    Humanoid:ChangeState(Enum.HumanoidStateType.Physics)
    
    local distancia = (HRP.Position - moeda.Position).Magnitude
    local tempoViagem = distancia / velocidade
    
    local tween = TweenService:Create(
        HRP, 
        TweenInfo.new(tempoViagem, Enum.EasingStyle.Linear),
        {CFrame = moeda.CFrame}
    )
    
    tween:Play()
    tween.Completed:Wait()
    
    Humanoid:ChangeState(Enum.HumanoidStateType.Running)
end

-- ==================== FUN√á√ïES DO KILL ALL ====================

local function GetPlayerRole(player)
    if not player or not player.Character then
        return "Innocent"
    end
    
    local char = player.Character
    local backpack = player:FindFirstChild("Backpack")
    
    if char and (char:FindFirstChild("Knife") or (backpack and backpack:FindFirstChild("Knife"))) then
        return "MURDERER"
    end
    
    if char and (char:FindFirstChild("Gun") or (backpack and backpack:FindFirstChild("Gun"))) then
        return "Sheriff"
    end
    
    return "Innocent"
end

local function KillAllFunction()
    killing = true
    
    spawn(function()
        while killAllEnabled and killing do
            task.wait(0.3)
            
            local success, err = pcall(function()
                if not LP.Character or not LP.Character:FindFirstChild("HumanoidRootPart") then
                    return
                end
                
                local myRole = GetPlayerRole(LP)
                local hrp = LP.Character.HumanoidRootPart
                
                if myRole == "MURDERER" and killAllEnabled then
                    for _, player in pairs(Players:GetPlayers()) do
                        if not killAllEnabled then return end
                        
                        if player ~= LP and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                            local targetHRP = player.Character.HumanoidRootPart
                            hrp.CFrame = targetHRP.CFrame
                            task.wait(0.2)
                        end
                    end
                elseif myRole ~= "MURDERER" and killAllEnabled then
                    killAllEnabled = false
                    killing = false
                end
            end)
        end
        killing = false
    end)
end

-- ==================== FUN√á√ïES DO ESP ====================

local function getESPColor(role)
    if role == "MURDERER" then
        return Color3.fromRGB(255, 80, 80)
    elseif role == "Sheriff" then
        return Color3.fromRGB(80, 80, 255)
    else
        return Color3.fromRGB(120, 255, 120)
    end
end

local function updateESP(target)
    if not espEnabled or not espCache[target] or not target.Character or not target.Character:FindFirstChild("Head") then 
        return 
    end
    
    pcall(function()
        local role = GetPlayerRole(target)
        local roleColor = getESPColor(role)
        
        if espCache[target].highlight then
            espCache[target].highlight.FillColor = roleColor
            espCache[target].highlight.OutlineColor = roleColor
        end
        
        if espCache[target].billboard then
            local nameLabel = espCache[target].billboard:FindFirstChild("NameLabel")
            local roleLabel = espCache[target].billboard:FindFirstChild("RoleLabel")
            
            if nameLabel then
                nameLabel.TextColor3 = roleColor
            end
            if roleLabel then
                roleLabel.Text = role
                roleLabel.TextColor3 = roleColor
            end
        end
    end)
end

local function createESP(target)
    if espCache[target] or not target.Character then return end
    
    pcall(function()
        if not target.Character:FindFirstChild("Head") then return end
        
        local role = GetPlayerRole(target)
        local roleColor = getESPColor(role)
        
        local highlight = Instance.new("Highlight", target.Character)
        highlight.FillColor = roleColor
        highlight.OutlineColor = roleColor
        highlight.FillTransparency = 0.5
        
        local billboardGui = Instance.new("BillboardGui", target.Character.Head)
        billboardGui.AlwaysOnTop = true
        billboardGui.Size = UDim2.new(0, 200, 0, 70)
        billboardGui.StudsOffset = Vector3.new(0, 3, 0)
        
        local nameLabel = Instance.new("TextLabel", billboardGui)
        nameLabel.Name = "NameLabel"
        nameLabel.Size = UDim2.new(1, 0, 0.6, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = target.Name
        nameLabel.TextColor3 = roleColor
        nameLabel.Font = Enum.Font.GothamBold
        nameLabel.TextSize = 18
        
        local roleLabel = Instance.new("TextLabel", billboardGui)
        roleLabel.Name = "RoleLabel"
        roleLabel.Size = UDim2.new(1, 0, 0.4, 0)
        roleLabel.Position = UDim2.new(0, 0, 0.6, 0)
        roleLabel.BackgroundTransparency = 1
        roleLabel.Text = role
        roleLabel.TextColor3 = roleColor
        roleLabel.Font = Enum.Font.GothamBold
        roleLabel.TextSize = 14
        
        espCache[target] = {
            highlight = highlight,
            billboard = billboardGui
        }
    end)
end

-- ==================== CRIAR INTERFACE DENTRO DO CONTENTFRAME ====================

-- T√≠tulo
local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0, 30)
titleLabel.Position = UDim2.new(0, 0, 0, 5)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "NCHUB - CONTROLES"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 18
titleLabel.Parent = contentFrame

-- Status do Autofarm
local autoStatus = Instance.new("TextLabel")
autoStatus.Size = UDim2.new(0.45, -5, 0, 30)
autoStatus.Position = UDim2.new(0, 0, 0, 40)
autoStatus.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
autoStatus.Text = "ü§ñ AUTO: OFF"
autoStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
autoStatus.Font = Enum.Font.GothamBold
autoStatus.TextSize = 14
autoStatus.Parent = contentFrame
Instance.new("UICorner", autoStatus).CornerRadius = UDim.new(0, 6)

-- Bot√£o Autofarm
local autoButton = Instance.new("TextButton")
autoButton.Size = UDim2.new(0.45, -5, 0, 30)
autoButton.Position = UDim2.new(0.55, 0, 0, 40)
autoButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
autoButton.Text = "LIGAR"
autoButton.TextColor3 = Color3.fromRGB(255, 255, 255)
autoButton.Font = Enum.Font.GothamBold
autoButton.TextSize = 14
autoButton.Parent = contentFrame
Instance.new("UICorner", autoButton).CornerRadius = UDim.new(0, 6)

-- Status do Kill All
local killStatus = Instance.new("TextLabel")
killStatus.Size = UDim2.new(0.45, -5, 0, 30)
killStatus.Position = UDim2.new(0, 0, 0, 75)
killStatus.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
killStatus.Text = "üî™ KILL: OFF"
killStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
killStatus.Font = Enum.Font.GothamBold
killStatus.TextSize = 14
killStatus.Parent = contentFrame
Instance.new("UICorner", killStatus).CornerRadius = UDim.new(0, 6)

-- Bot√£o Kill All
local killButton = Instance.new("TextButton")
killButton.Size = UDim2.new(0.45, -5, 0, 30)
killButton.Position = UDim2.new(0.55, 0, 0, 75)
killButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
killButton.Text = "LIGAR"
killButton.TextColor3 = Color3.fromRGB(255, 255, 255)
killButton.Font = Enum.Font.GothamBold
killButton.TextSize = 14
killButton.Parent = contentFrame
Instance.new("UICorner", killButton).CornerRadius = UDim.new(0, 6)

-- Status do ESP
local espStatus = Instance.new("TextLabel")
espStatus.Size = UDim2.new(0.45, -5, 0, 30)
espStatus.Position = UDim2.new(0, 0, 0, 110)
espStatus.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
espStatus.Text = "üëÅÔ∏è ESP: OFF"
espStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
espStatus.Font = Enum.Font.GothamBold
espStatus.TextSize = 14
espStatus.Parent = contentFrame
Instance.new("UICorner", espStatus).CornerRadius = UDim.new(0, 6)

-- Bot√£o ESP
local espButton = Instance.new("TextButton")
espButton.Size = UDim2.new(0.45, -5, 0, 30)
espButton.Position = UDim2.new(0.55, 0, 0, 110)
espButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
espButton.Text = "LIGAR"
espButton.TextColor3 = Color3.fromRGB(255, 255, 255)
espButton.Font = Enum.Font.GothamBold
espButton.TextSize = 14
espButton.Parent = contentFrame
Instance.new("UICorner", espButton).CornerRadius = UDim.new(0, 6)

-- Configura√ß√µes (quando clicar no configBtn da topbar)
local configFrame = Instance.new("Frame")
configFrame.Size = UDim2.new(1, 0, 1, 0)
configFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
configFrame.Visible = false
configFrame.Parent = contentFrame
Instance.new("UICorner", configFrame).CornerRadius = UDim.new(0, 12)

-- T√≠tulo Config
local configTitle = Instance.new("TextLabel")
configTitle.Size = UDim2.new(1, 0, 0, 35)
configTitle.Position = UDim2.new(0, 0, 0, 10)
configTitle.BackgroundTransparency = 1
configTitle.Text = "‚öôÔ∏è CONFIGURA√á√ïES"
configTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
configTitle.Font = Enum.Font.GothamBold
configTitle.TextSize = 18
configTitle.Parent = configFrame

-- Velocidade
local speedLabel = Instance.new("TextLabel")
speedLabel.Size = UDim2.new(0.4, -5, 0, 35)
speedLabel.Position = UDim2.new(0, 10, 0, 50)
speedLabel.BackgroundTransparency = 1
speedLabel.Text = "Velocidade:"
speedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
speedLabel.Font = Enum.Font.Gotham
speedLabel.TextSize = 16
speedLabel.TextXAlignment = Enum.TextXAlignment.Left
speedLabel.Parent = configFrame

local speedBox = Instance.new("TextBox")
speedBox.Size = UDim2.new(0.5, -10, 0, 35)
speedBox.Position = UDim2.new(0.5, 0, 0, 50)
speedBox.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
speedBox.Text = "30"
speedBox.TextColor3 = Color3.fromRGB(255, 255, 255)
speedBox.Font = Enum.Font.Gotham
speedBox.TextSize = 16
speedBox.Parent = configFrame
Instance.new("UICorner", speedBox).CornerRadius = UDim.new(0, 8)

-- Info ESP
local infoLabel = Instance.new("TextLabel")
infoLabel.Size = UDim2.new(1, -20, 0, 80)
infoLabel.Position = UDim2.new(0, 10, 0, 100)
infoLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
infoLabel.Text = "üé® CORES ESP:\nüî¥ Murderer\nüîµ Sheriff\nüü¢ Innocent"
infoLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
infoLabel.Font = Enum.Font.Gotham
infoLabel.TextSize = 14
infoLabel.TextWrapped = true
infoLabel.Parent = configFrame
Instance.new("UICorner", infoLabel).CornerRadius = UDim.new(0, 8)

-- ==================== L√ìGICA DOS BOT√ïES ====================

-- Bot√£o Config na topbar
configBtn.MouseButton1Click:Connect(function()
    contentFrame.Visible = not contentFrame.Visible
    configFrame.Visible = not configFrame.Visible
end)

-- Autofarm
autoButton.MouseButton1Click:Connect(function()
    isRunning = not isRunning
    
    if isRunning then
        autoStatus.Text = "ü§ñ AUTO: ON"
        autoStatus.TextColor3 = Color3.fromRGB(100, 255, 100)
        autoButton.BackgroundColor3 = Color3.fromRGB(50, 255, 50)
        autoButton.Text = "DESLIGAR"
    else
        autoStatus.Text = "ü§ñ AUTO: OFF"
        autoStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
        autoButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        autoButton.Text = "LIGAR"
    end
end)

-- Kill All
killButton.MouseButton1Click:Connect(function()
    killAllEnabled = not killAllEnabled
    
    if killAllEnabled then
        local myRole = GetPlayerRole(LP)
        
        if myRole == "MURDERER" then
            killStatus.Text = "üî™ KILL: ON"
            killStatus.TextColor3 = Color3.fromRGB(100, 255, 100)
            killButton.BackgroundColor3 = Color3.fromRGB(50, 255, 50)
            killButton.Text = "DESLIGAR"
            
            if not killing then
                KillAllFunction()
            end
        else
            killAllEnabled = false
            -- Notifica√ß√£o silenciosa
        end
    else
        killStatus.Text = "üî™ KILL: OFF"
        killStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
        killButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        killButton.Text = "LIGAR"
        killing = false
    end
end)

-- ESP
espButton.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    
    if espEnabled then
        espStatus.Text = "üëÅÔ∏è ESP: ON"
        espStatus.TextColor3 = Color3.fromRGB(100, 255, 100)
        espButton.BackgroundColor3 = Color3.fromRGB(50, 255, 50)
        espButton.Text = "DESLIGAR"
    else
        espStatus.Text = "üëÅÔ∏è ESP: OFF"
        espStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
        espButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        espButton.Text = "LIGAR"
        
        for _, cache in pairs(espCache) do
            pcall(function()
                if cache.highlight then cache.highlight:Destroy() end
                if cache.billboard then cache.billboard:Destroy() end
            end)
        end
        espCache = {}
    end
end)

-- Velocidade
speedBox.FocusLost:Connect(function()
    local valor = tonumber(speedBox.Text)
    if valor and valor > 0 and valor <= 200 then
        velocidade = valor
    else
        speedBox.Text = tostring(velocidade)
    end
end)

-- Teclas de atalho
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.T then
        isRunning = not isRunning
        if isRunning then
            autoStatus.Text = "ü§ñ AUTO: ON"
            autoStatus.TextColor3 = Color3.fromRGB(100, 255, 100)
            autoButton.BackgroundColor3 = Color3.fromRGB(50, 255, 50)
            autoButton.Text = "DESLIGAR"
        else
            autoStatus.Text = "ü§ñ AUTO: OFF"
            autoStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
            autoButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
            autoButton.Text = "LIGAR"
        end
    elseif input.KeyCode == Enum.KeyCode.Insert then
        espEnabled = not espEnabled
        if espEnabled then
            espStatus.Text = "üëÅÔ∏è ESP: ON"
            espStatus.TextColor3 = Color3.fromRGB(100, 255, 100)
            espButton.BackgroundColor3 = Color3.fromRGB(50, 255, 50)
            espButton.Text = "DESLIGAR"
        else
            espStatus.Text = "üëÅÔ∏è ESP: OFF"
            espStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
            espButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
            espButton.Text = "LIGAR"
            
            for _, cache in pairs(espCache) do
                pcall(function()
                    if cache.highlight then cache.highlight:Destroy() end
                    if cache.billboard then cache.billboard:Destroy() end
                end)
            end
            espCache = {}
        end
    end
end)

-- ==================== LOOPS ====================

-- Loop do Autofarm
spawn(function()
    while true do
        if isRunning then
            local moeda = encontrarMoedaMaisProxima()
            
            if moeda then
                irAteMoeda(moeda)
                
                local visual = moeda:FindFirstChild("CoinVisual")
                if visual then
                    repeat
                        task.wait(0.1)
                    until not visual.Parent or visual:GetAttribute("Collected")
                end
            else
                task.wait(0.5)
            end
        else
            task.wait(0.1)
        end
    end
end)

-- Loop do Kill All para verificar se perdeu a faca
spawn(function()
    while true do
        task.wait(1)
        if killAllEnabled then
            local myRole = GetPlayerRole(LP)
            if myRole ~= "MURDERER" then
                killAllEnabled = false
                killing = false
                
                killStatus.Text = "üî™ KILL: OFF"
                killStatus.TextColor3 = Color3.fromRGB(255, 100, 100)
                killButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
                killButton.Text = "LIGAR"
            end
        end
    end
end)

-- Loop do ESP (ATUALIZA√á√ÉO EM TEMPO REAL)
RunService.RenderStepped:Connect(function()
    if espEnabled then
        for _, otherPlayer in pairs(Players:GetPlayers()) do
            if otherPlayer ~= LP then
                if not espCache[otherPlayer] then
                    createESP(otherPlayer)
                else
                    updateESP(otherPlayer)
                end
            end
        end
    end
end)

-- ==================== EVENTOS ====================

-- Limpar ESP quando jogador sai
Players.PlayerRemoving:Connect(function(target)
    if espCache[target] then
        pcall(function()
            if espCache[target].highlight then
                espCache[target].highlight:Destroy()
            end
            if espCache[target].billboard then
                espCache[target].billboard:Destroy()
            end
        end)
        espCache[target] = nil
    end
end)

-- Atualizar personagem
LP.CharacterAdded:Connect(function(novoChar)
    Char = novoChar
    HRP = Char:WaitForChild("HumanoidRootPart")
    Humanoid = Char:WaitForChild("Humanoid")
end)

print("üöÄ NCHUB Carregado com sucesso!")
print("üìå Autofarm: Tecla T")
print("üìå ESP: Tecla INSERT")
print("üìå Kill All: S√≥ funciona como Murderer")
