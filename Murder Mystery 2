-- NCHUB - Murder Mystery 2
-- Baseado em script funcional (V.G Hub)

-- Carregar sua biblioteca primeiro
loadstring(game:HttpGet("https://raw.githubusercontent.com/SyK3RPh/NCHUB/main/Library.lua"))()

-- Agora o script funcional
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

-- Configura√ß√µes
local Settings = {
    SilentAim = {Enabled = false, FOV = 150},
    ESP = {Murder = false, Sheriff = false, Innocent = false, Items = false},
    Player = {Walkspeed = 16, JumpPower = 50, Fly = false, Noclip = false, InfiniteJump = false},
    Misc = {AntiAfk = false, FullBright = false}
}

-- Fun√ß√µes de ESP (testadas)
local function GetRole(plr)
    if not plr or not plr.Character then return "Innocent" end
    local tool = plr.Character:FindFirstChildWhichIsA("Tool")
    if tool then
        if tool.Name:lower():find("knife") then return "Murderer" end
        if tool.Name:lower():find("gun") then return "Sheriff" end
    end
    return "Innocent"
end

-- Cores bonitas
local Colors = {
    Murder = Color3.fromRGB(255, 70, 70),    -- Vermelho vivo
    Sheriff = Color3.fromRGB(70, 120, 255),  -- Azul royal
    Innocent = Color3.fromRGB(120, 255, 120) -- Verde clarinho
}

-- Loop de ESP
RunService.Heartbeat:Connect(function()
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
            local role = GetRole(plr)
            local shouldESP = (role == "Murderer" and Settings.ESP.Murder) or
                             (role == "Sheriff" and Settings.ESP.Sheriff) or
                             (role == "Innocent" and Settings.ESP.Innocent)
            
            if shouldESP then
                if not plr.Character:FindFirstChild("ESPBox") then
                    local highlight = Instance.new("Highlight")
                    highlight.Name = "ESPBox"
                    highlight.FillColor = Colors[role]
                    highlight.FillTransparency = 0.4
                    highlight.OutlineColor = Color3.new(1, 1, 1)
                    highlight.Parent = plr.Character
                end
            else
                local esp = plr.Character:FindFirstChild("ESPBox")
                if esp then esp:Destroy() end
            end
        end
    end
end)

-- ESP Items
RunService.Heartbeat:Connect(function()
    if Settings.ESP.Items then
        for _, v in pairs(workspace:GetDescendants()) do
            if v:IsA("Tool") and v:FindFirstChild("Handle") then
                if not v:FindFirstChild("ItemESP") then
                    local bill = Instance.new("BillboardGui")
                    bill.Name = "ItemESP"
                    bill.Size = UDim2.new(0, 50, 0, 20)
                    bill.AlwaysOnTop = true
                    bill.Parent = v.Handle
                    
                    local text = Instance.new("TextLabel")
                    text.Size = UDim2.new(1, 0, 1, 0)
                    text.BackgroundTransparency = 1
                    text.Text = v.Name:lower():find("gun") and "üî´" or "üî™"
                    text.TextColor3 = v.Name:lower():find("gun") and Color3.new(1, 1, 0) or Color3.new(1, 0, 0)
                    text.TextScaled = true
                    text.Font = Enum.Font.GothamBold
                    text.Parent = bill
                end
            end
        end
    else
        for _, v in pairs(workspace:GetDescendants()) do
            if v:IsA("Tool") and v:FindFirstChild("Handle") then
                local esp = v.Handle:FindFirstChild("ItemESP")
                if esp then esp:Destroy() end
            end
        end
    end
end)

-- Fun√ß√µes de teleporte
local function TeleportTo(pos)
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(pos)
    end
end

-- Anti AFK
LocalPlayer.Idled:Connect(function()
    if Settings.Misc.AntiAfk then
        game:GetService("VirtualUser"):CaptureController()
        game:GetService("VirtualUser"):ClickButton2(Vector2.new())
    end
end)

-- Infinite Jump
UserInputService.JumpRequest:Connect(function()
    if Settings.Player.InfiniteJump and LocalPlayer.Character then
        LocalPlayer.Character:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
    end
end)

-- Full Bright
RunService.Heartbeat:Connect(function()
    if Settings.Misc.FullBright then
        game.Lighting.Brightness = 2
        game.Lighting.Ambient = Color3.new(1, 1, 1)
    else
        game.Lighting.Brightness = 1
        game.Lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
    end
end)

-- GUI da NCHUB (seu design)
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NCHUB"
ScreenGui.Parent = game.CoreGui

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 400, 0, 300)
MainFrame.Position = UDim2.new(0.5, -200, 0.5, -150)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = MainFrame

-- TopBar
local TopBar = Instance.new("Frame")
TopBar.Size = UDim2.new(1, 0, 0, 40)
TopBar.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
TopBar.BorderSizePixel = 0
TopBar.Parent = MainFrame

local TopCorner = Instance.new("UICorner")
TopCorner.CornerRadius = UDim.new(0, 12)
TopCorner.Parent = TopBar

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(0, 150, 1, 0)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "NCHUB - MM2"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 16
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TopBar

-- Bot√µes da TopBar
local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 30, 1, 0)
CloseBtn.Position = UDim2.new(1, -35, 0, 0)
CloseBtn.BackgroundTransparency = 1
CloseBtn.Text = "‚úï"
CloseBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
CloseBtn.TextSize = 18
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Parent = TopBar
CloseBtn.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)

-- Tabs
local TabContainer = Instance.new("Frame")
TabContainer.Size = UDim2.new(1, -20, 0, 35)
TabContainer.Position = UDim2.new(0, 10, 0, 45)
TabContainer.BackgroundColor3 = Color3.fromRGB(25, 25, 33)
TabContainer.BorderSizePixel = 0
TabContainer.Parent = MainFrame

local TabCorner = Instance.new("UICorner")
TabCorner.CornerRadius = UDim.new(0, 8)
TabCorner.Parent = TabContainer

local Tabs = {"ESP", "PLAYER", "MISC", "TP"}
local TabButtons = {}
local TabContents = {}

for i, name in ipairs(Tabs) do
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 80, 1, 0)
    btn.Position = UDim2.new(0, 5 + (i-1) * 85, 0, 0)
    btn.BackgroundColor3 = Color3.fromRGB(35, 35, 43)
    btn.Text = name
    btn.TextColor3 = Color3.fromRGB(200, 200, 200)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    btn.Parent = TabContainer
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 6)
    btnCorner.Parent = btn
    
    local content = Instance.new("ScrollingFrame")
    content.Size = UDim2.new(1, -20, 0, 180)
    content.Position = UDim2.new(0, 10, 0, 85)
    content.BackgroundTransparency = 1
    content.BorderSizePixel = 0
    content.ScrollBarThickness = 4
    content.Visible = false
    content.Parent = MainFrame
    
    TabButtons[i] = btn
    TabContents[name] = content
    
    btn.MouseButton1Click:Connect(function()
        for _, b in ipairs(TabButtons) do
            b.BackgroundColor3 = Color3.fromRGB(35, 35, 43)
        end
        for _, c in pairs(TabContents) do
            c.Visible = false
        end
        btn.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
        content.Visible = true
    end)
end

-- Fun√ß√£o pra criar toggle
local function CreateToggle(parent, text, setting, path)
    local yPos = #parent:GetChildren() * 40
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, 0, 0, 30)
    frame.Position = UDim2.new(0, 0, 0, yPos)
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
    frame.Parent = parent
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = frame
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(0, 200, 1, 0)
    label.Position = UDim2.new(0, 10, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = frame
    
    local toggle = Instance.new("TextButton")
    toggle.Size = UDim2.new(0, 40, 0, 20)
    toggle.Position = UDim2.new(1, -45, 0.5, -10)
    toggle.BackgroundColor3 = Color3.fromRGB(80, 80, 90)
    toggle.Text = "OFF"
    toggle.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggle.Font = Enum.Font.GothamBold
    toggle.TextSize = 10
    toggle.Parent = frame
    
    local toggleCorner = Instance.new("UICorner")
    toggleCorner.CornerRadius = UDim.new(0, 4)
    toggleCorner.Parent = toggle
    
    toggle.MouseButton1Click:Connect(function()
        if path == "ESP" then
            Settings.ESP[setting] = not Settings.ESP[setting]
        elseif path == "Player" then
            Settings.Player[setting] = not Settings.Player[setting]
        elseif path == "Misc" then
            Settings.Misc[setting] = not Settings.Misc[setting]
        end
        
        if toggle.BackgroundColor3 == Color3.fromRGB(80, 80, 90) then
            toggle.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
            toggle.Text = "ON"
        else
            toggle.BackgroundColor3 = Color3.fromRGB(80, 80, 90)
            toggle.Text = "OFF"
        end
    end)
end

-- Fun√ß√£o pra criar bot√£o
local function CreateButton(parent, text, callback)
    local yPos = #parent:GetChildren() * 40
    
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, 0, 0, 30)
    btn.Position = UDim2.new(0, 0, 0, yPos)
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 65)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    btn.Parent = parent
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = btn
    
    btn.MouseButton1Click:Connect(callback)
end

-- Preencher tabs
CreateToggle(TabContents["ESP"], "üî¥ Murder", "Murder", "ESP")
CreateToggle(TabContents["ESP"], "üîµ Sheriff", "Sheriff", "ESP")
CreateToggle(TabContents["ESP"], "üü¢ Innocent", "Innocent", "ESP")
CreateToggle(TabContents["ESP"], "üî´ Items", "Items", "ESP")

CreateToggle(TabContents["PLAYER"], "üïäÔ∏è Fly", "Fly", "Player")
CreateToggle(TabContents["PLAYER"], "üëª Noclip", "Noclip", "Player")
CreateToggle(TabContents["PLAYER"], "‚òÅÔ∏è Infinite Jump", "InfiniteJump", "Player")

CreateToggle(TabContents["MISC"], "üí§ Anti AFK", "AntiAfk", "Misc")
CreateToggle(TabContents["MISC"], "üí° Full Bright", "FullBright", "Misc")

CreateButton(TabContents["TP"], "üè† Lobby", function()
    TeleportTo(Vector3.new(0, 50, 0))
end)

CreateButton(TabContents["TP"], "üó∫Ô∏è Mapa", function()
    TeleportTo(Vector3.new(100, 50, 100))
end)

CreateButton(TabContents["TP"], "üî´ Arma", function()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("Tool") and v.Name:lower():find("gun") then
            TeleportTo(v.Position + Vector3.new(0, 3, 0))
            break
        end
    end
end)

-- Selecionar primeira tab
TabButtons[1].BackgroundColor3 = Color3.fromRGB(60, 60, 80)
TabContents["ESP"].Visible = true

-- Dragging
local dragging = false
local dragStart
local startPos

TopBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)

TopBar.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

print("‚úÖ NCHUB - MM2 carregado com sucesso!")
