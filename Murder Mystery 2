-- NCHUB - Biblioteca Personaliz√°vel com Aba Farm
-- Top bar com tudo, conte√∫do livre embaixo

-- Criar tela
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "NCHUB"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Tela de carregamento
local loadingFrame = Instance.new("Frame")
loadingFrame.Name = "Loading"
loadingFrame.Size = UDim2.new(0, 150, 0, 70)
loadingFrame.Position = UDim2.new(0.5, -75, 0.5, -35)
loadingFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
loadingFrame.BackgroundTransparency = 0.1
loadingFrame.BorderSizePixel = 0
loadingFrame.Parent = screenGui
loadingFrame.ZIndex = 10

local loadingCorner = Instance.new("UICorner")
loadingCorner.CornerRadius = UDim.new(0, 12)
loadingCorner.Parent = loadingFrame

local loadingText = Instance.new("TextLabel")
loadingText.Size = UDim2.new(1, 0, 1, 0)
loadingText.BackgroundTransparency = 1
loadingText.Text = "NCHUB"
loadingText.TextColor3 = Color3.fromRGB(255, 255, 255)
loadingText.Font = Enum.Font.GothamBold
loadingText.TextSize = 28
loadingText.Parent = loadingFrame

-- Aguardar 2 segundos
task.wait(2)

loadingFrame:TweenPosition(UDim2.new(0.5, -75, 1.5, 0), "Out", "Quad", 0.5, true)
task.wait(0.5)
loadingFrame:Destroy()

-- GUI Principal
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 420, 0, 340)
mainFrame.Position = UDim2.new(0.5, -210, 0.5, -170)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 16)
mainCorner.Parent = mainFrame

-- TOP BAR
local topBar = Instance.new("Frame")
topBar.Name = "TopBar"
topBar.Size = UDim2.new(1, 0, 0, 45)
topBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
topBar.BorderSizePixel = 0
topBar.Parent = mainFrame

local topBarCorner = Instance.new("UICorner")
topBarCorner.CornerRadius = UDim.new(0, 16)
topBarCorner.Parent = topBar

-- Nome do Hub
local hubName = Instance.new("TextLabel")
hubName.Size = UDim2.new(0, 120, 1, 0)
hubName.Position = UDim2.new(0, 12, 0, 0)
hubName.BackgroundTransparency = 1
hubName.Text = "NCHUB"
hubName.TextColor3 = Color3.fromRGB(255, 255, 255)
hubName.Font = Enum.Font.GothamBold
hubName.TextSize = 18
hubName.TextXAlignment = Enum.TextXAlignment.Left
hubName.Parent = topBar

-- Container dos bot√µes
local buttonContainer = Instance.new("Frame")
buttonContainer.Size = UDim2.new(0, 120, 1, 0)
buttonContainer.Position = UDim2.new(1, -130, 0, 0)
buttonContainer.BackgroundTransparency = 1
buttonContainer.Parent = topBar

-- Bot√£o Config
local configBtn = Instance.new("TextButton")
configBtn.Size = UDim2.new(0, 30, 1, 0)
configBtn.Position = UDim2.new(0, 0, 0, 0)
configBtn.BackgroundTransparency = 1
configBtn.Text = "‚öôÔ∏è"
configBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
configBtn.TextSize = 20
configBtn.Font = Enum.Font.Gotham
configBtn.Parent = buttonContainer

-- Bot√£o Minimizar/Maximizar
local minMaxBtn = Instance.new("TextButton")
minMaxBtn.Size = UDim2.new(0, 30, 1, 0)
minMaxBtn.Position = UDim2.new(0, 30, 0, 0)
minMaxBtn.BackgroundTransparency = 1
minMaxBtn.Text = "‚àí"
minMaxBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
minMaxBtn.TextSize = 24
minMaxBtn.Font = Enum.Font.GothamBold
minMaxBtn.Parent = buttonContainer

-- Bot√£o Fechar
local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 30, 1, 0)
closeBtn.Position = UDim2.new(0, 60, 0, 0)
closeBtn.BackgroundTransparency = 1
closeBtn.Text = "‚úï"
closeBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
closeBtn.TextSize = 18
closeBtn.Font = Enum.Font.GothamBold
closeBtn.Parent = buttonContainer

-- Bot√£o Ajuda
local helpBtn = Instance.new("TextButton")
helpBtn.Size = UDim2.new(0, 30, 1, 0)
helpBtn.Position = UDim2.new(0, 90, 0, 0)
helpBtn.BackgroundTransparency = 1
helpBtn.Text = "?"
helpBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
helpBtn.TextSize = 20
helpBtn.Font = Enum.Font.GothamBold
helpBtn.Parent = buttonContainer

-- √Årea de Conte√∫do
local contentArea = Instance.new("ScrollingFrame")
contentArea.Name = "ContentArea"
contentArea.Size = UDim2.new(1, -20, 1, -60)
contentArea.Position = UDim2.new(0, 10, 0, 55)
contentArea.BackgroundTransparency = 1
contentArea.BorderSizePixel = 0
contentArea.ScrollBarThickness = 4
contentArea.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
contentArea.CanvasSize = UDim2.new(0, 0, 0, 150)
contentArea.Parent = mainFrame

-- Dragging
local dragging = false
local dragStart
local startPos

topBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
    end
end)

topBar.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if dragging then
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end
end)

-- Fechar
closeBtn.MouseButton1Click:Connect(function() screenGui:Destroy() end)
closeBtn.TouchTap:Connect(function() screenGui:Destroy() end)

-- Minimizar/Maximizar (reduz o GUI todo)
local minimized = false
local originalSize = mainFrame.Size
local minimizedSize = UDim2.new(0, 420, 0, 45) -- S√≥ top bar vis√≠vel

minMaxBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        mainFrame:TweenSize(minimizedSize, "Out", "Quad", 0.2, true)
        minMaxBtn.Text = "+"
        contentArea.Visible = false
    else
        mainFrame:TweenSize(originalSize, "Out", "Quad", 0.2, true)
        minMaxBtn.Text = "‚àí"
        contentArea.Visible = true
    end
end)

-- Config e Ajuda
configBtn.MouseButton1Click:Connect(function()
    print("Abrir configura√ß√µes")
end)

helpBtn.MouseButton1Click:Connect(function()
    print("Ajuda - NCHUB v1.0")
end)

-- ============================================
-- ABA FARM - Script de Coleta de Moedas
-- ============================================

-- Vari√°veis do Farm
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local LP = Players.LocalPlayer
local isFarming = false
local Char = LP.Character or LP.CharacterAdded:Wait()
local HRP = Char:WaitForChild("HumanoidRootPart")
local Humanoid = Char:WaitForChild("Humanoid")

-- Criar aba Farm
local farmTab = Instance.new("Frame")
farmTab.Name = "FarmTab"
farmTab.Size = UDim2.new(1, -20, 0, 120)
farmTab.Position = UDim2.new(0, 10, 0, 10)
farmTab.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
farmTab.BackgroundTransparency = 0.3
farmTab.BorderSizePixel = 0
farmTab.Parent = contentArea

local farmTabCorner = Instance.new("UICorner")
farmTabCorner.CornerRadius = UDim.new(0, 12)
farmTabCorner.Parent = farmTab

-- T√≠tulo da aba
local farmTitle = Instance.new("TextLabel")
farmTitle.Size = UDim2.new(1, -20, 0, 30)
farmTitle.Position = UDim2.new(0, 10, 0, 10)
farmTitle.BackgroundTransparency = 1
farmTitle.Text = "üåæ FARM AFK"
farmTitle.TextColor3 = Color3.fromRGB(200, 200, 255)
farmTitle.Font = Enum.Font.GothamBold
farmTitle.TextSize = 18
farmTitle.TextXAlignment = Enum.TextXAlignment.Left
farmTitle.Parent = farmTab

-- Bot√£o Farm AFK
local farmButton = Instance.new("TextButton")
farmButton.Name = "FarmButton"
farmButton.Size = UDim2.new(0, 150, 0, 40)
farmButton.Position = UDim2.new(0.5, -75, 0, 50)
farmButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
farmButton.Text = "FARM AFK: OFF"
farmButton.TextColor3 = Color3.fromRGB(255, 255, 255)
farmButton.Font = Enum.Font.GothamBold
farmButton.TextSize = 16
farmButton.Parent = farmTab

local farmButtonCorner = Instance.new("UICorner")
farmButtonCorner.CornerRadius = UDim.new(0, 8)
farmButtonCorner.Parent = farmButton

-- Status do Farm
local farmStatus = Instance.new("TextLabel")
farmStatus.Size = UDim2.new(1, -20, 0, 25)
farmStatus.Position = UDim2.new(0, 10, 0, 95)
farmStatus.BackgroundTransparency = 1
farmStatus.Text = "‚è∏Ô∏è Parado"
farmStatus.TextColor3 = Color3.fromRGB(150, 150, 150)
farmStatus.Font = Enum.Font.Gotham
farmStatus.TextSize = 14
farmStatus.TextXAlignment = Enum.TextXAlignment.Left
farmStatus.Parent = farmTab

-- Fun√ß√µes do Farm
local function encontrarMoedaMaisProxima()
    local mapa = nil
    for _, obj in ipairs(workspace:GetChildren()) do
        if obj:FindFirstChild("CoinContainer") or obj:FindFirstChild("Coins") then
            mapa = obj
            break
        end
    end
    
    if not mapa then return nil end
    
    local container = mapa:FindFirstChild("CoinContainer") or mapa:FindFirstChild("Coins")
    if not container then return nil end
    
    local moedaMaisProxima = nil
    local menorDistancia = math.huge
    
    for _, moeda in ipairs(container:GetChildren()) do
        local visual = moeda:FindFirstChild("CoinVisual")
        if visual and not visual:GetAttribute("Collected") then
            local distancia = (HRP.Position - moeda.Position).Magnitude
            if distancia < menorDistancia then
                moedaMaisProxima = moeda
                menorDistancia = distancia
            end
        end
    end
    
    return moedaMaisProxima
end

local function irAteMoeda(moeda)
    if not moeda or not HRP or not Humanoid then return false end
    
    Humanoid:ChangeState(Enum.HumanoidStateType.Physics)
    
    local distancia = (HRP.Position - moeda.Position).Magnitude
    local tempoViagem = distancia / 30
    
    local tween = TweenService:Create(
        HRP, 
        TweenInfo.new(tempoViagem, Enum.EasingStyle.Linear),
        {CFrame = moeda.CFrame}
    )
    
    tween:Play()
    tween.Completed:Wait()
    
    Humanoid:ChangeState(Enum.HumanoidStateType.Running)
    return true
end

local function atualizarBotaoFarm()
    if isFarming then
        farmButton.BackgroundColor3 = Color3.fromRGB(100, 255, 100)
        farmButton.Text = "FARM AFK: ON"
        farmStatus.Text = "‚ñ∂Ô∏è Coletando moedas..."
        farmStatus.TextColor3 = Color3.fromRGB(100, 255, 100)
    else
        farmButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
        farmButton.Text = "FARM AFK: OFF"
        farmStatus.Text = "‚è∏Ô∏è Parado"
        farmStatus.TextColor3 = Color3.fromRGB(150, 150, 150)
    end
end

-- Clique no bot√£o Farm
farmButton.MouseButton1Click:Connect(function()
    isFarming = not isFarming
    atualizarBotaoFarm()
end)

-- Loop principal do Farm
spawn(function()
    while true do
        if isFarming then
            -- Verifica se est√° vivo
            if LP.Character and LP.Character:FindFirstChild("Humanoid") and LP.Character.Humanoid.Health > 0 then
                local moeda = encontrarMoedaMaisProxima()
                
                if moeda then
                    local sucesso = irAteMoeda(moeda)
                    
                    if sucesso then
                        -- Espera a moeda ser coletada
                        local visual = moeda:FindFirstChild("CoinVisual")
                        if visual then
                            repeat
                                task.wait(0.1)
                            until not visual.Parent or visual:GetAttribute("Collected")
                        end
                    end
                else
                    farmStatus.Text = "‚è≥ Procurando moedas..."
                    task.wait(0.5)
                end
            else
                farmStatus.Text = "üíÄ Morto - Aguardando respawn..."
                task.wait(1)
            end
        else
            task.wait(0.1)
        end
    end
end)

-- Atualiza quando o personagem renasce
LP.CharacterAdded:Connect(function(novoChar)
    Char = novoChar
    HRP = Char:WaitForChild("HumanoidRootPart")
    Humanoid = Char:WaitForChild("Humanoid")
    print("Personagem renasceu - Farm atualizado")
end)

-- ============================================
-- FIM DA ABA FARM
-- ============================================

-- Atualizar canvas size
local function UpdateCanvas()
    local height = 0
    for _, v in pairs(contentArea:GetChildren()) do
        if v:IsA("Frame") then
            height = height + v.Size.Y.Offset + 15
        end
    end
    contentArea.CanvasSize = UDim2.new(0, 0, 0, height + 20)
end

UpdateCanvas()

print("‚úÖ NCHUB carregado com aba FARM!")
